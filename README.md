# Тестовое задание стажеру службы поддержки пользователей. 

1. **Ответ на проблему с принтером:**

   Здравствуйте! Мы провели диагностику работы принтера и выявили проблему с его настройками. В данный момент мы предпринимаем все необходимые шаги для восстановления его работоспособности. Ожидайте дальнейших уведомлений от нашей стороны.

   С уважением, Гончаров Михаил.

2. **Ответ на письмо о почтовых сервисах:**

   Добрый день! Мы провели тщательную проверку работы почтового сервиса и выявили некоторые неполадки в его настройках. В настоящее время мы работаем над исправлением проблемы и в ближайшее время вышлем вам подробный отчет о проделанных действиях.

   С уважением, Гончаров Михаил.

5. **Заявка проблеме с принтером**
   Сначала я бы решил проблему с принтером, поскольку распечатка важных документов требуется для большего числа сотрудников, чем исправление проблемы с почтовым клиентом. Если наш компьютер подключен к локальной сети с этим принтером, можно сделать следующее с собственного компьютера:

   | № | Возможная причина             | Решение                                                                               |
   |---|-------------------------------|---------------------------------------------------------------------------------------|
   | 1 | Принтер отключен.            | Заходим: параметры → устройства → принтеры и сканеры. Проверьте подключение принтера. |
   | 2 | Конфликт приоритетов.        | Проверьте, установлен ли нужный принтер по умолчанию.                                  |
   | 3 | Ошибка в очереди печати.     | Зайдите в раздел "Принтеры и сканеры" и выберите нужный принтер. Очистите очередь печати. Проверьте во вкладке "Принтеры" отсутствие галочек напротив "Приостановить печать" и "Работать автономно". Если они есть, снимите их. |
   | 4 | Проверка актуальности драйверов. | Откройте "Панель управления" → "Все элементы панели управления" → "Диспетчер устройств". Проверьте наличие вопросительных знаков напротив устройств. |
   | 5 | Проверка служб.              | Пуск → выполнить: services.msc → ОК. Убедитесь, что службы "Публикация ресурсов обнаружения функций" и "Диспетчер печати" имеют "Тип запуска: Автоматически". |
   | 6 | Ошибка порта.                | Зайдите в "Принтеры и сканеры". Нажмите правой кнопкой мыши на нужном принтере и выберите "Свойства принтера". Перейдите на вкладку "Порты" и выберите нужный порт для USB. Снова установите нужный принтер по умолчанию. |


#### 4. Заявка о проблеме почтового клиента, если это Outlook.
**Причина: Outlook не подключен к Интернету.**

Решение. Пользователи должны сначала попытаться определить, подключен ли их компьютер к Интернету или нет. Вы можете использовать веб-браузер, чтобы проверить, могут ли они получить доступ к Интернет-сайтам. Если кто-то использует локальную сеть, попробуйте зайти на любой веб-сайт, чтобы узнать, работает ли Интернет. Если ваше интернет-соединение работает нормально, убедитесь, что Outlook подключен к сети. Для этого перейдите в меню Outlook и убедитесь, что опция «Работа в автономном режиме» не отмечена.

**Причина: для некоторых учетных записей электронной почты POP и IMAP, использующих SMTP, требуется проверка подлинности.**

Решение: если все настройки Outlook верны, но все же, если вы столкнулись с проблемой получения почты MS Outlook в Outlook 2007 и других версиях, можно попробовать включить аутентификацию SMTP. Ниже приведены шаги для этого:
    - В Outlook перейдите на вкладку Инструменты и выберите Учетные записи. 
    - В мастере учетных записей выберите учетную запись 
    - Теперь в разделе Сервер исходящей почты выберите Дополнительные параметры. 
    - Во всплывающем окне Аутентификация выберите тип аутентификации и введите учетные данные.
  
3. **Причина: неправильные настройки POP или IMAP в Outlook.**
Решение. Иногда неправильные настройки POP или IMAP в учетной записи Outlook пользователя мешают ему получать сообщения электронной почты. Таким образом, чтобы проверить настройки учетной записи и исправить проблемы с отправкой и получением Outlook, выполните следующие действия:
Перейдите в настройки учетной записи POP и IMAP и убедитесь, что введенные данные верны:
    - Ваше имя: имя отправителя, которое они хотели бы отображать в электронных письмах. 
    - Адрес электронной почты: Ваш полный адрес электронной почты 
    - Тип учетной записи: POP3 или IMAP 
    - Сервер входящей почты: для учетных записей POP или IMAP это должен быть mail.papamail.net. 
    - Сервер исходящей почты (SMTP): для учетных записей POP или IMAP используйте mail.papamail.net 
    - Имя пользователя: имя пользователя вашей учетной записи электронной почты. 
    - Пароль: пароль от вашего почтового ящика. 

   **Сети необходим прокси-сервер для подключения к почтовому серверу.**
Решение: если пользователь использует сеть для подключения к Интернету, ему, возможно, придется указать почтовый прокси-сервер в системных настройках компьютера. Для этого можно спросить у сетевого администратора точные настройки почтового прокси-сервера. Проблемы с настройками сети могут привести к ошибкам входящей почты Outlook, а не к ошибкам в работе. Значит, нужно исправить это с самого начала.

   **Письма не приходят из-за фильтра защиты от нежелательной почты.**
Решение. Фильтр защиты от нежелательной почты также блокирует входящие сообщения электронной почты с определенных доменов и адресов электронной почты. Чтобы решить эту проблему, выполните следующие действия:
Отключите фильтрацию нежелательной почты Outlook в Outlook 2007:
    - В меню Действия нажмите Нежелательная почта. 
    - Теперь выберите Нежелательная почта >> Без автоматической фильтрации >> ОК. 
Отключите фильтрацию нежелательной почты Outlook в Outlook 2010:
    - Щелкните папку Нежелательная почта >> Нежелательная почта. 
    - Выберите Параметры нежелательной почты >> Без автоматической фильтрации >> ОК.
  
   **Наличие подозрительных писем в учетной записи Outlook.**
Решение. Иногда пользователи получают вредоносный код в свой почтовый ящик Outlook через ненадежных отправителей, что останавливает входящие службы приложения. В этот момент пользователи должны удалить такие сообщения электронной почты из своего почтового ящика. Эти подозрительные электронные письма могут в конечном итоге вызвать проблемы с получением электронной почты в Outlook 2007 и других версиях.

   **Outlook конфликтует с антивирусным ПО.**
Решение. Часто бывает, что подключаемый модуль антивируса в Microsoft Outlook создает барьер для входящего сервера. В этом состоянии пользователи должны следовать указаниям производителя антивируса, чтобы обеспечить безошибочную совместимость между антивирусом и почтовым клиентом Outlook. Несколько проверенных антивирусных компаний предоставляют соответствующие инструкции на своих официальных сайтах.

   Надстройки не позволяют Outlook получать электронные письма.
Решение: поскольку надстройки Outlook полезны для расширения функциональности приложения, однако во многих случаях с ними могут возникать проблемы. Для их отключения пользователям необходимо запустить Outlook в безопасном режиме. Ниже приведены шаги для того же:
    - Откройте панель управления и перейдите в раздел Удаление программ. 
    - Теперь выберите Outlook из списка установленных программ. 
    - Щелкните его правой кнопкой мыши и выберите Восстановить. 
    - После этого следуйте инструкциям отображаемого мастера. 

#### 5. Решение проблемы с доставкой писем на Linux с неизвестным почтовым клиентом

Если проблем с отправкой нет, значит есть проблема между сервером приема и почтовым клиентом. Для начала прочитаем логи почтового клиента:

```bash
cat /var/log/mail.log*
```
Наименование лог-файла может варьироваться в зависимости от конкретного почтового клиента.

Формат логов зависит от конкретного почтового клиента. Примеры вывода:

```
1. Configuration error: Invalid server address specified
2. Error connecting to mail server: Connection timed out
3. Warning: Unable to send email. Please check your internet connection.
4. SSL certificate verification failed. Please check your server settings.
```
### Решения:
#### 5.1. Вывод данной команды укажет на синтаксические ошибки:
```bash
postfix check mail*.conf
```
#### 5.2. Возможно нужный порт блокируется 2.1.другим приложением. 2.2.firewall 2.3.антивирусом. Нам нужны следующие порты: 25, 110(для POP3), 465 и 587
Для проверки сети между клиентом и сервером воспользуемся одним из этих инструментов:
#### 5.2.1
```bash
telnet <адрес_сервера> <порт> 
sudo tcpdump -i <интерфейс> port <порт> 
```
Если проблема в порте, то в telnet нам выведет страничку домашнею страничку сервера, который по ошибки располагается на данном порту. В таком случае, нам нужно найти конфигурационный файл этого приложение и найти там строчку:
```
LISTEN [порт].
```
И далее с помощью команд:
```bash
sudo systemctl reload [name_servies] — перезапускаем нужные службы без их остановки.
```
#### Изменение портов в других приложенях требует дополнительных согласований с team leader!
#### 5.2.2 Отключите антивирус. Протестируйте.
#### 5.2.3. Для начала можно проверить настройки DNS-сервера. Если не поможет.
От некоторых адресов письма все-таки приходят, и так как эти абоненты в локальной сети, мы можем добавить их точечно.

Проверяем есть ли DROP или REJECT на портах.
```bash
sudo iptables -L | grep :[номер порта] — Проверим есть ли блокировка на нужные нам порты.
iptables -I INPUT -s [ip-абонента] -j ACCEPT
```
Если сотрудник слишком занят и не может проверить доходят ли ему письма. То для самостоятельного тестирования нам потребуется: временно сменить ip, host и имя своей учетной записи на проблемное. 
Динамически меняем ip:

```bash
sudo ifconfig [интерфейс] [новый IP-адрес] для изменения IP-адреса
```
А быстро отправлять письма можно с помощью mailx. Не забудте сменить host и имя своей учетной записи на проблемное.
Вот краткий мануал по использованию: 
```
https://www.dmosk.ru/miniinstruktions.php?mini=mail-shell
```
Если правило работает, то сохраняем:
```bash
sudo iptables-save >> /etc/iptables/rules.v4.
```
Обращаю Ваше внимание, что  знак «>>» не перезаписывает, а добавляет строчку в конец. Когда флаг -I ставит правило в приоритет. Таким образом мы не сбиваем старые настройки. 
P.S Я понимаю, что представленные в пункте 2 решения спорны. От части это из-за недостатка информации в "дано". Пожалуйста, дайте мне обратную связь.

#### 5.3. Если определенные письма доходят, а соедение до прочих сайтов устанавливается успешно, то предлагаю опустить этот пункт.
Некоторые почтовые фильтры могут сканировать содержимое электронной почты и отклонять письма, если они передаются без шифрования SSL/TLS. 
Иногда ssl-сертефикаты сбиваются из-за сбитого времени на локальном компьютере.

```bash
sudo apt update
sudo apt install ntp
```

Вот пример базовой конфигурации /etc/ntp.conf:
```
# Файл конфигурации NTP (/etc/ntp.conf)

# Определение серверов времени, с которых будет получаться синхронизация
server 0.pool.ntp.org
server 1.pool.ntp.org
server 2.pool.ntp.org

# Разрешить доступ к управлению сервером времени по локальной сети
restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap

# Разрешить доступ к управлению сервером времени с локального хоста
restrict 127.0.0.1

# Настройки логгирования
logfile /var/log/ntp.log

```
Также может помочь обновление пакетов на проблемном компьютере. Можно написать ansible мини-роль, которая будет выполнять следующие команды:
```bash
sudo apt/yum update
sudo apt/yum upgrade
```
* в зависимости от того debian или redhat

```bash
sudo systemctl restart ntp
ntpq -p
crontab -e
0 0 1 3,10 * /usr/sbin/ntpdate -s time.nist.gov
```
Последняя строка указывает, что команда будет выполняться в 00:00 (полночь) первого числа месяца в марте и октябре каждого года.

Как быстро обновить ssl-ключи?
Переходим на сайт:
https://certbot.eff.org/
и выбираем сервис и систему для установки.
Можно установить в начале для nginx, а потом для  apache2.
Следуем инструкциям.
SSL-сертефикаты Обновляются за 2 минуты.

#### Также я уведомлю финансовый отдел о возможной задержке дедлайна, если процесс устранения неисправностей затянется.
#### По завершении работы обязательно уведомлю коллег.
#### Вернулся к выполнению задачи от финансового отдела.

P.p.s.
Во время собеседования я растерялся и не ответил на вопрос, что такое tcp/ip. 
TCP/ip -это стек протоколов: tcp и ip. tcp протокол - это некий почтальон-джентельмен, который, прежде чем отправить письмо, обязательно узнает, сможет ли он его принять. В протоколах транспотного уровня обычно большое письмо делиться на "пакеты" - более маленькие письма. Так вот, tcp - пронумерует пакеты и позаботится о том, чтобы к получателю они дошли в нужном порядке и внадлежащем виде. ip-протокол. Это правило указания адресов. ip делятся на локальные, частные и публичные и если какого-либо ip нет в локальной сети, то запрос уходит через шлюз в другую сеть.


